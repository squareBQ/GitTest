# 接口返回null情况说明

1. 基本数据类型 or 特定 `Object`

```json
{
    "code":"10000",
    "data":"这是返回数据"
}
```

2. 数组、集合数据类型

```json
{
    "code":"10000",
    "data": [
        "1", "2", "3", "4"
    ]
}
```

```json
{
    "code":"10000",
    "data": [
        {"id":1, "word":"A"}, 
        {"id":2, "word":"B"}, 
        {"id":3, "word":"C"}, 
        {"id":4, "word":"D"}
    ]
}
```

一般在有数据返回的情况下，这两种 `json` 解析都不会出现问题。但是如果数据返回 `null` 或者空的情况呢，那就不一定了。

比如下面两种数据返回；

```json
{
    "code":"10000",
    "data":null
}
```
情况1，接口返回 `data` 为 `null`, 此时客户端该如何定义 `data` 的数据类型呢？

一般来说，客户端会跟服务器端确认 `data` 的数据类型，然后在终端进行匹配。正常 `data` 返回基本数据类型或者特定的 obj 类型，然后客户端对应解析，那就没啥问题了。但是如果是下面这种返回，那情况就不一样了。

```json
{
    "code":"10000",
    "data": []
}
```
情况2，接口返回 `data` 为空集合，此时客户端必然会将 `data` 定义为数组或集合并解析，如果是正常返回自然也不会有问题。

问题就出在情况1和情况2杂糅的时候，最常见的是 `data` 定义为数组或集合数据的时候，接口却返回了【情况1】的数据结构。

这时候，终端就懵逼了，本来定义好的是解析成集合数据，接口却返回个 `"data":null` ，由此就存在隐患了。

如果终端不做数据兼容，或者由于网络框架本身限制导致无法正常解析，那就很容易出现程序 Crash 的情况。

碰到这种情况，如果终端代码框架无法做兼容上的修改，那就只能请后台修改空集合的数据返回了；当然如果终端代码能够做兼容处理，那自然是最好的，自己动手丰衣足食。

其实，这就是前后端接口数据结构没有规范导致的问题，所以一般项目开发前期，都会约定一套完整的开发规则，后期开发人员都严格按照规则执行，这样的问题就会大大的减少和被避免。

最后，还是要沟通解决问题。

参考：[高效Java第三版-54. 返回空的数组或集合，不要返回 null](http://www.mianquan.net/tutorial/effective-java-3rd-chinese/docs-notes-54.%20%E8%BF%94%E5%9B%9E%E7%A9%BA%E7%9A%84%E6%95%B0%E7%BB%84%E6%88%96%E9%9B%86%E5%90%88%EF%BC%8C%E4%B8%8D%E8%A6%81%E8%BF%94%E5%9B%9E%20null.md)